"use strict";(self.webpackChunkfluss_website=self.webpackChunkfluss_website||[]).push([[7828],{898:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"maintenance/observability/metric-reporters","title":"Metric Reporters","description":"\x3c!--","source":"@site/docs/maintenance/observability/metric-reporters.md","sourceDirName":"maintenance/observability","slug":"/maintenance/observability/metric-reporters","permalink":"/docs/next/maintenance/observability/metric-reporters","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/fluss/edit/main/website/docs/maintenance/observability/metric-reporters.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Metric Reporters","sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Quickstart Guides","permalink":"/docs/next/maintenance/observability/quickstart"},"next":{"title":"Monitor Metrics","permalink":"/docs/next/maintenance/observability/monitor-metrics"}}');var n=t(4848),i=t(8453);const o={title:"Metric Reporters",sidebar_position:2},l="Metric Reporters",a={},c=[{value:"Push vs. Pull",id:"push-vs-pull",level:2},{value:"Reporters",id:"reporters",level:2},{value:"JMX",id:"jmx",level:3},{value:"Prometheus",id:"prometheus",level:3}];function d(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"metric-reporters",children:"Metric Reporters"})}),"\n",(0,n.jsxs)(r.p,{children:["Fluss allows reporting ",(0,n.jsx)(r.a,{href:"/docs/next/maintenance/observability/monitor-metrics",children:"metrics"})," to external system.\nMetrics can be exposed to an external system by configuring one or several reporters in ",(0,n.jsx)(r.code,{children:"conf/server.yaml"}),". These\nreporters will be instantiated on each CoordinatorServer and TabletServers when they started."]}),"\n",(0,n.jsx)(r.p,{children:"Example reporter configuration that specifies multiple reporters:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-yaml",children:"metrics.reporters: jmx,prometheus\n"})}),"\n",(0,n.jsx)(r.h2,{id:"push-vs-pull",children:"Push vs. Pull"}),"\n",(0,n.jsx)(r.p,{children:"Metrics are exported either via pushes or pulls."}),"\n",(0,n.jsxs)(r.p,{children:["Push-based reporters usually implement the ",(0,n.jsx)(r.code,{children:"Scheduled"})," interface and periodically send a summary of current metrics to an external system."]}),"\n",(0,n.jsx)(r.p,{children:"Pull-based reporters are queried from an external system instead."}),"\n",(0,n.jsx)(r.h2,{id:"reporters",children:"Reporters"}),"\n",(0,n.jsx)(r.p,{children:"The following sections list the supported reporters currently."}),"\n",(0,n.jsx)(r.h3,{id:"jmx",children:"JMX"}),"\n",(0,n.jsx)(r.p,{children:"Type: pull"}),"\n",(0,n.jsx)(r.p,{children:"Parameters:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"port"})," - (optional) the port on which JMX listens for connections.\nIn order to be able to run several instances of the reporter on one host (e.g. when one TabletServer is co-located with the CoordinatorServer) it is advisable to use a port range like ",(0,n.jsx)(r.code,{children:"9250-9260"}),".\nWhen a range is specified the actual port is shown in the relevant server log.\nIf this setting is set, Fluss will start an extra JMX connector for the given port/range.\nMetrics are always available on the default local JMX interface."]}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"Example configuration:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-yaml",children:"metrics.reporters: jmx\nmetrics.reporter.jmx.port: 9250-9260\n"})}),"\n",(0,n.jsx)(r.p,{children:"Metrics exposed through JMX are identified by a domain and a list of key-properties, which together form the object name."}),"\n",(0,n.jsxs)(r.p,{children:["The domain always begins with ",(0,n.jsx)(r.code,{children:"com.alibaba.fluss"})," followed by a generalized metric identifier.\nAn example for such a domain would be ",(0,n.jsx)(r.code,{children:"com.alibaba.fluss.tabletserver.replicaCount"}),"."]}),"\n",(0,n.jsxs)(r.p,{children:["The key-property list contains the values for all variables, that are associated\nwith a given metric.\nAn example for such a list would be ",(0,n.jsx)(r.code,{children:"cluster_id=fluss1,host=localhost,server_id=1"}),"."]}),"\n",(0,n.jsx)(r.p,{children:"The domain thus identifies a metric class, while the key-property list identifies one (or multiple) instances of that metric."}),"\n",(0,n.jsx)(r.h3,{id:"prometheus",children:"Prometheus"}),"\n",(0,n.jsx)(r.p,{children:"Type: pull"}),"\n",(0,n.jsx)(r.p,{children:"Parameters:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"metrics.reporter.prometheus.port"})," - (optional) the port the Prometheus exporter listens on, defaults to ",(0,n.jsx)(r.a,{href:"https://github.com/prometheus/prometheus/wiki/Default-port-allocations",children:"9249"}),". In order to be able to run several instances of the reporter on one host (e.g. when one TabletServer is co-located with the CoordinatorServer) it is advisable to use a port range like ",(0,n.jsx)(r.code,{children:"9250-9260"}),"."]}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"Example configuration:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-yaml",children:"metrics.reporters: prometheus\nmetrics.reporter.prometheus.port: 9250\n"})}),"\n",(0,n.jsx)(r.p,{children:"Fluss metric types are mapped to Prometheus metric types as follows:"}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Fluss"}),(0,n.jsx)(r.th,{children:"Prometheus"}),(0,n.jsx)(r.th,{children:"Note"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Counter"}),(0,n.jsx)(r.td,{children:"Gauge"}),(0,n.jsx)(r.td,{children:"Prometheus counters cannot be decremented."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Gauge"}),(0,n.jsx)(r.td,{children:"Gauge"}),(0,n.jsx)(r.td,{children:"Only numbers and booleans are supported."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Histogram"}),(0,n.jsx)(r.td,{children:"Summary"}),(0,n.jsx)(r.td,{children:"Quantiles .5, .75, .95, .98, .99 and .999"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Meter"}),(0,n.jsx)(r.td,{children:"Gauge"}),(0,n.jsx)(r.td,{children:"The gauge exports the meter's rate."})]})]})]})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,r,t)=>{t.d(r,{R:()=>o,x:()=>l});var s=t(6540);const n={},i=s.createContext(n);function o(e){const r=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),s.createElement(i.Provider,{value:r},e.children)}}}]);